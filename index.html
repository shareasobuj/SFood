<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SFood.com | অর্ডার ট্র্যাকিং ও প্রোফাইল</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        :root { --primary: #ff4757; --secondary: #2ed573; --dark: #2f3542; --light: #f1f2f6; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Hind Siliguri', sans-serif; }
        body { background: var(--light); padding-top: 80px; }

        header { background: #fff; padding: 15px 8%; position: fixed; width: 100%; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .nav-links { list-style: none; display: flex; align-items: center; }
        #userStatus { font-weight: bold; color: var(--primary); margin-right: 15px; }

        .container { padding: 20px 8%; max-width: 1200px; margin: 0 auto; }
        
        /* Profile & Welcome Box */
        .profile-card { background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .location-info { background: #e3f2fd; padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 14px; color: #0277bd; }

        /* Menu Grid */
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-top: 20px; }
        .card { background: #fff; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); text-align: center; }
        .card img { width: 100%; border-radius: 10px; height: 160px; object-fit: cover; }

        /* Order History Table */
        .history-box { background: #fff; padding: 20px; border-radius: 15px; margin-top: 40px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #ddd; }
        th { background: var(--light); }

        /* Modal & Buttons */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); align-items: center; justify-content: center; }
        .modal-content { background: #fff; padding: 30px; border-radius: 15px; width: 90%; max-width: 400px; }
        .modal-content input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; }
        
        .btn { background: var(--primary); color: #fff; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn:hover { opacity: 0.8; }
        .btn-order { width: 100%; margin-top: 10px; }
        .btn-logout { background: #747d8c; margin-top: 15px; }
        
        .hidden { display: none; }
        .status-badge { background: var(--secondary); color: white; padding: 2px 8px; border-radius: 15px; font-size: 12px; }
    </style>
</head>
<body>

    <header>
        <div style="font-size: 24px; font-weight: bold; cursor:pointer" onclick="location.reload()">SFood<span>.com</span></div>
        <div class="nav-links">
            <span id="userStatus">অতিথি</span>
            <button class="btn" id="authBtn" onclick="openAuth()">লগইন</button>
        </div>
    </header>

    <div class="container">
        <div id="welcomeZone" class="profile-card hidden">
            <h2>স্বাগতম, <span id="userNameDisplay"></span>!</h2>
            <p><i class="fas fa-phone"></i> ফোন: <span id="userPhoneDisplay"></span></p>
            <div id="locationDisplay" class="location-info">
                <i class="fas fa-map-marker-alt"></i> লোকেশন ট্রেসিং অ্যাক্টিভ...
            </div>
            <button class="btn btn-logout" onclick="logout()">লগ আউট</button>
        </div>

        <h3 style="margin-top: 20px;">আমাদের মেনু</h3>
        <div class="menu-grid">
            <div class="card">
                <img src="https://images.unsplash.com/photo-1571091718767-18b5b1457add?w=400" alt="Burger">
                <h4>চিকেন বার্গার</h4>
                <p>৳ ২২০</p>
                <button class="btn btn-order" onclick="placeOrder('চিকেন বার্গার', 220)">অর্ডার করুন</button>
            </div>
            <div class="card">
                <img src="https://images.unsplash.com/photo-1513104890138-7c749659a591?w=400" alt="Pizza">
                <h4>মার্গারিটা পিৎজা</h4>
                <p>৳ ৪৫০</p>
                <button class="btn btn-order" onclick="placeOrder('মার্গারিটা পিৎজা', 450)">অর্ডার করুন</button>
            </div>
            <div class="card">
                <img src="https://images.unsplash.com/photo-1551183053-bf91a1d81141?w=400" alt="Pasta">
                <h4>ক্রিমি পাস্তা</h4>
                <p>৳ ৩০০</p>
                <button class="btn btn-order" onclick="placeOrder('ক্রিমি পাস্তা', 300)">অর্ডার করুন</button>
            </div>
        </div>

        <div class="history-box" id="historySection">
            <h3><i class="fas fa-shopping-bag"></i> আপনার অর্ডার হিস্ট্রি</h3>
            <div id="noOrderMsg">এখনো কোনো অর্ডার করেননি।</div>
            <table id="historyTable" class="hidden">
                <thead>
                    <tr>
                        <th>তারিখ</th>
                        <th>খাবার</th>
                        <th>মূল্য</th>
                        <th>অবস্থা</th>
                    </tr>
                </thead>
                <tbody id="historyBody"></tbody>
            </table>
        </div>
    </div>

    <div id="authModal" class="modal">
        <div class="modal-content">
            <h3>রেজিস্ট্রেশন করুন</h3>
            <input type="text" id="regName" placeholder="আপনার নাম">
            <input type="tel" id="regPhone" placeholder="ফোন নম্বর">
            <input type="text" id="regAddress" placeholder="ডেলিভারি ঠিকানা">
            <button class="btn btn-order" onclick="saveUserData()">তথ্য সেভ করুন</button>
            <button class="btn btn-order" style="background:#ccc" onclick="closeAuth()">বাতিল</button>
        </div>
    </div>

    <script>
        // --- অ্যাপ স্টেট ম্যানেজমেন্ট ---
        window.onload = function() {
            checkUser();
            updateHistoryTable();
        }

        function openAuth() { document.getElementById('authModal').style.display = 'flex'; }
        function closeAuth() { document.getElementById('authModal').style.display = 'none'; }

        // ক্রেতার তথ্য সেভ করা
        function saveUserData() {
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;
            const address = document.getElementById('regAddress').value;

            if(name && phone && address) {
                const userData = { name, phone, address };
                localStorage.setItem('sfood_user', JSON.stringify(userData));
                closeAuth();
                checkUser();
                getLocation();
            } else { alert("দয়া করে সব তথ্য দিন।"); }
        }

        function checkUser() {
            const user = JSON.parse(localStorage.getItem('sfood_user'));
            if(user) {
                document.getElementById('userStatus').innerText = user.name;
                document.getElementById('authBtn').classList.add('hidden');
                document.getElementById('welcomeZone').classList.remove('hidden');
                document.getElementById('userNameDisplay').innerText = user.name;
                document.getElementById('userPhoneDisplay').innerText = user.phone;
                getLocation();
            }
        }

        // অর্ডার প্লেস করা এবং হিস্ট্রিতে সেভ করা
        function placeOrder(itemName, price) {
            const user = JSON.parse(localStorage.getItem('sfood_user'));
            if(!user) {
                alert("অর্ডার করতে আগে লগইন করুন!");
                openAuth();
                return;
            }

            const newOrder = {
                date: new Date().toLocaleDateString(),
                item: itemName,
                price: price,
                status: 'Processing'
            };

            // লোকাল স্টোরেজে অর্ডার লিস্ট আপডেট করা
            let orders = JSON.parse(localStorage.getItem('sfood_orders')) || [];
            orders.push(newOrder);
            localStorage.setItem('sfood_orders', JSON.stringify(orders));

            alert(`ধন্যবাদ ${user.name}! আপনার ${itemName} অর্ডারটি সফল হয়েছে।`);
            updateHistoryTable();
        }

        // অর্ডার হিস্ট্রি টেবিল আপডেট করা
        function updateHistoryTable() {
            const orders = JSON.parse(localStorage.getItem('sfood_orders')) || [];
            const table = document.getElementById('historyTable');
            const tbody = document.getElementById('historyBody');
            const msg = document.getElementById('noOrderMsg');

            if(orders.length > 0) {
                table.classList.remove('hidden');
                msg.classList.add('hidden');
                tbody.innerHTML = '';
                orders.reverse().forEach(order => {
                    tbody.innerHTML += `
                        <tr>
                            <td>${order.date}</td>
                            <td>${order.item}</td>
                            <td>৳ ${order.price}</td>
                            <td><span class="status-badge">${order.status}</span></td>
                        </tr>
                    `;
                });
            }
        }

        function logout() {
            localStorage.clear();
            location.reload();
        }

        // জিপিএস লোকেশন ট্রেসিং
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((pos) => {
                    document.getElementById('locationDisplay').innerHTML = 
                        `<i class="fas fa-check-circle"></i> লোকেশন ট্রেসড: ${pos.coords.latitude.toFixed(3)}, ${pos.coords.longitude.toFixed(3)}`;
                });
            }
        }
    </script>
</body>
              </html>
